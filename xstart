#!/usr/bin/env bash

export QT_QPA_PLATFORMTHEME="qt5ct"
export _JAVA_OPTIONS="\
          -Dawt.useSystemAAFontSettings=lcd \
          -Dswing.aatext=true \
          -Dswing.crossplatformlaf=com.sun.java.swing.plaf.gtk.GTKLookAndFeel"

# Workaround for electron/chrome based apps timeout while connecting to
kill -TERM $(pgrep -f "gnome-keyring-daemon")

# Configure ssh-agent
ssh-add -k

# X settings
xrdb -load "$HOME/.Xresources"
xsetroot -cursor_name left_ptr

# Configure desktop
"$HOME/bin/desktop.sh"
xset dpms 300 300 300

# Daemons
sxhkd &
"$HOME/bin/start-mopidy.sh" &
/usr/lib/notification-daemon/notification-daemon &
redshift -r &
syndaemon -i 0.5 -K -R -d
xautolock -locker "$HOME/bin/lock.sh" -time 5 -detectsleep &
xcape -t 250 -e 'Caps_Lock=Escape'
(cd "$HOME/Documents/Home" || exit; python -m SimpleHTTPServer) &

# Autostarting daemons
dex /etc/xdg/autostart/polkit-gnome-authentication-agent-1.desktop
dex /etc/xdg/autostart/gnome-keyring-pkcs11.desktop
dex /etc/xdg/autostart/gnome-keyring-secrets.desktop
dex /etc/xdg/autostart/gnome-keyring-ssh.desktop

# Tray applets
dex /etc/xdg/autostart/blueman.desktop
dex /etc/xdg/autostart/hplip-systray.desktop
dex /etc/xdg/autostart/nm-applet.desktop
dex /etc/xdg/autostart/print-applet.desktop

# Applications
dex /usr/share/applications/insync.desktop

# Disable touchscreen
TOUCHSCREEN=$(xinput list | grep SYNA | sed 's/.*id=\([0-9]*\).*/\1/g')
xinput disable "$TOUCHSCREEN"
